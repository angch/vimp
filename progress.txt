# Ralph Progress Log

## Codebase Patterns
- Build: Use `tools/zig build` for consistent environment (bootstrapped via `Makefile`).
- Zig 0.15+: Use `root_module` in `b.addExecutable` instead of `root_source_file`.
- Zig 0.15+: `build.zig.zon` requires correct `.fingerprint` (use compiler suggestion).
- GTK4: `gtk_init` requires a display connection; expected failure in headless CI/Agent envs.
- Zig 0.15+: `callconv(.C)` removed; use `callconv(std.builtin.CallingConvention.c)`.
- GTK4 C-ABI: Use `gtk_css_provider_load_from_data` for CSS loading (safer than `load_from_string` across versions).
- GTK4 Callbacks: Ensure function signatures strictly match C headers (e.g. `[*c]` or `?*` vs `*`). Zig 0.15+ is strict about optional vs non-optional pointers in callbacks.
- Dependencies: Use `tools/setup_libs.sh` to download and extract GEGL/Babl to `./libs` for local development. `build.zig` is configured to look there.

## 2026-01-29 - US-001
- Implemented US-001 by vendoring GEGL-0.4 and Babl-0.1 via `tools/setup_libs.sh`.
- Modified `build.zig` to link against libraries in `./libs` and set RPATH.
- Updated `src/main.zig` to include GEGL and Babl headers.
- **Learnings for future iterations:**
  - GEGL/Babl binaries are obtained from Ubuntu packages via `apt-get download` and extracted, as standalone static binaries are erratic/unavailable.
  - `build.zig` uses `addIncludePath` and `addLibraryPath` to prioritize vendored libs over system libs.
  - Runtime dependency (rpath) is handled via `exe.addRPath`.
